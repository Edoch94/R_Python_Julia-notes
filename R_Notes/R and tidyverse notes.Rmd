---
title: "R and tidyverse notes"
output: html_notebook
---

### Uso di map() su lista contenente dataframe
Voglio applicare a ciascun dataframe una funzione che cambia il nome dell'ultima colonna con il nome "nuovo_nome" rename(df, nuovo_nome = last_col())
```{r}
library(tidyverse)
library(magrittr)
library(waldo)
data(mtcars)

df1 <- tail(mtcars)
df2 <- mtcars[1:5, 2:10]
df3 <- mtcars
df4 <- head(mtcars)
list_cars <- list(df1, df2, df3, df4)

list_cars_renamed <- map(list_cars, .f = ~{.x %>% rename(rank = last_col())})

# Una alternativa praticamente identica è la seguente
list_cars_renamed2 <- map(list_cars, .f = ~.x %>% rename(rank = last_col()))

compare(list_cars_renamed, list_cars_renamed2)
```

### Uso di sql_render 
sql_render permette di trasformare codice scritto con tidyverse in codice sql
```{r}
library(tidyverse)
library(magrittr)
library(dbplyr)

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
copy_to(con, mtcars)
mtcars_sql_code <- tbl(con, "mtcars")
DBI::dbDisconnect(con)

# mtcars <- as_tibble(mtcars)
mtcars_sql_code <- mtcars_sql_code %>%
  select(-gear) %>%
  group_by(cyl) %>%
  summarise(wt = mean(wt)) 

sql_render(mtcars_sql_code)

```


### Uso di tesseract e preprocessamento con magick
tesseract permette di trasformare in stringhe il testo contenuto in immagini
```{r}
library(tidyverse)
library(magrittr)
library(tesseract)
library(magick)

# Download lingua per il riconoscimento del testo
# tesseract::tesseract_download("ita")

# Caricamento nell'env della lingua
ita_lang <- tesseract::tesseract("ita")

# Definizione percorso immagine
img_path <- file.path("D:","Documenti","Git_repositories","R_Python_Notes","R_Notes","Altro")

# Lettura testo nell'immagine
testo_immagine <- tesseract::ocr(image = file.path(img_path, "immagine_test_1.png"), engine = ita_lang)
testo_immagine

# Informazioni riguardo la'attendibilità della lettura dell'immagine
testo_immagine_info <- tesseract::ocr_data(image = file.path(img_path, "immagine_test_1.png"), engine = ita_lang)
testo_immagine_info

# Preprocessamento immagine con magick



```


